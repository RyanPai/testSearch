(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{175:function(e,t,n){"use strict";(function(e){var a=n(101),o=n(100),i=n(176),l=n(177),r=n(196),c=n(178),s=n(195),d=n(16),u=n(179),h=n(0),p=n.n(h),m=n(180),f=n.n(m),w=n(181),g=n.n(w),v=n(182),y=n.n(v),b=(n(278),n(62)),E=n.n(b),k=n(98),I=n.n(k),O=n(97),j=n.n(O),S=n(192),x=n.n(S),C=n(194),D=n.n(C),P=n(28),T=n.n(P),A=n(193),F=n.n(A),M=n(99),Z=n.n(M),L=n(186),U=n.n(L),B=n(188),q=n.n(B),z=n(60),V=n.n(z),_=n(189),G=n.n(_),J=n(61),K=n.n(J),N=n(59),W=n.n(N),X=n(93),Q=n.n(X),$=n(183),H=n(191),R=n.n(H),Y=n(96),ee=n(190),te=n.n(ee);function ne(){var e=Object(u.a)(["","",""]);return ne=function(){return e},e}var ae=$.a.div(ne(),Y.spacing,Y.palette),oe=function(t){function n(e){var t;return Object(i.a)(this,n),(t=Object(r.a)(this,Object(c.a)(n).call(this,e))).state={isSigin:!1,files:[],childrens:[],series:{},searchMethod:"input",inputText:"",downloadType:{product:!0,upc:!1},downloadDone:!1,searchItem:{},downloadLoading:!1,url:"",base64:"",pdf:""},t.loadClient=t.loadClient.bind(Object(d.a)(Object(d.a)(t))),t.loadFiles=t.loadFiles.bind(Object(d.a)(Object(d.a)(t))),t.loadSeries=t.loadSeries.bind(Object(d.a)(Object(d.a)(t))),t.seriesInit=t.seriesInit.bind(Object(d.a)(Object(d.a)(t))),t.onDownloadZIP=t.onDownloadZIP.bind(Object(d.a)(Object(d.a)(t))),t.downloadData=t.downloadData.bind(Object(d.a)(Object(d.a)(t))),t.onSaveFileZIP=t.onSaveFileZIP.bind(Object(d.a)(Object(d.a)(t))),t}return Object(s.a)(n,t),Object(l.a)(n,[{key:"componentDidMount",value:function(){window.gapi.load("client:auth2",this.initClient.bind(this))}},{key:"initClient",value:function(){window.gapi.client.init({apiKey:"AIzaSyAAKJOAw6uBXpKhpAkXQy0e0pPFxpNMraM",clientId:"1090032071436-ejoeke6m3hupc8i8p41u6tf2pl1scmld.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.metadata.readonly https://www.googleapis.com/auth/drive.photos.readonly https://www.googleapis.com/auth/drive.readonly"}).then(function(){},function(e){console.log(e)})}},{key:"updateSigninStatus",value:function(e){console.log(e)}},{key:"authenticate",value:function(){return window.gapi.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/drive.metadata.readonly https://www.googleapis.com/auth/drive.photos.readonly https://www.googleapis.com/auth/drive.readonly"}).then(function(){console.log("Sign-in successful")},function(e){console.error("Error signing in",e)})}},{key:"loadClient",value:function(){var e=this;return window.gapi.client.load("https://content.googleapis.com/discovery/v1/apis/drive/v2/rest").then(function(){console.log("GAPI client loaded for API"),e.setState({isSigin:!0})},function(e){console.error("Error loading GAPI client for API",e)})}},{key:"handleAuthClick",value:function(e){window.gapi;this.authenticate().then(this.loadClient)}},{key:"loadFiles",value:function(){var e=this;window.gapi.client.drive.files.list({}).then(function(t){e.setState({files:Object(o.a)(t.result.items)})},function(e){console.error("Execute error",e)})}},{key:"loadSeries",value:function(e){var t=this,n=window.gapi;n.client.drive.files.list({q:"'".concat(e,"' in parents")}).then(function(e){e.result.items.map(function(e){n.client.drive.files.list({q:"'".concat(e.id,"' in parents")}).then(function(n){n.result.items.length&&(n.result.type=e.title,t.state.childrens=[].concat(Object(o.a)(t.state.childrens),[n.result]),t.seriesInit())},function(e){console.error("Execute error",e)})})},function(e){console.error("Execute error",e)})}},{key:"seriesInit",value:function(){var e=this,t=this.state.childrens;t.length>=2&&t.map(function(t){t.items.map(function(n){e.state.series[n.title]=e.state.series[n.title]||{},e.state.series[n.title]["UPC"==t.type?"upc":"product"]=n.id})})}},{key:"onDownloadZIP",value:function(){var e=this,t=window.gapi,n=this.state,a=n.searchMethod,o=n.downloadType;(this.setState({downloadLoading:!0,downloadDone:!1}),this.state.searchItem={},"input"==a)?this.state.inputText.split(/[\n||,]/).map(function(e){return e.split(/[-_\/]/)}).map(function(n){if(n[0]){var a=n.join("-");e.state.searchItem[a]={data:[]};var i="fullText contains '".concat(n[0],"'");n.map(function(e,t){t>0&&(i+=" and fullText contains '".concat(e,"'"))}),t.client.drive.files.list({q:i}).then(function(t){var n=t.result.items.filter(function(t){return o.product&&o.upc?(e.downloadData({key:a,url:t.downloadUrl,type:t.fileExtension,title:t.title}),t):o.product&&"pdf"!=t.fileExtension?(e.downloadData({key:a,url:t.downloadUrl,type:t.fileExtension,title:t.title}),"pdf"!=t.fileExtension):o.upc&&"pdf"==t.fileExtension?(e.downloadData({key:a,url:t.downloadUrl,type:t.fileExtension,title:t.title}),"pdf"==t.fileExtension):void 0});e.state.searchItem[a].items=n},function(e){console.error("Execute error",e)})}}):console.log(this.state.searchItem)}},{key:"downloadData",value:function(t){var n=this,a=t.key,o=t.url,i=t.type,l=t.title,r=window.gapi;f()({method:"get",responseType:"arraybuffer",url:o,headers:{Authorization:"".concat(r.auth.getToken().token_type," ").concat(r.auth.getToken().access_token)}}).then(function(t){var o;o="pdf"==i?new Blob([t.data],{type:"application/pdf"}):new e(t.data,"binary").toString("base64"),n.state.searchItem[a].data.push({data:o,type:i,key:a,title:l}),n.state.searchItem[a].items.length==n.state.searchItem[a].data.length&&(n.state.searchItem[a].done=!0,n.onSaveFileZIP())})}},{key:"onSaveFileZIP",value:function(){var e=this,t=this.state.searchItem,n=Object.keys(t).map(function(e){return e}),a=Object.keys(t).filter(function(e){return t[e].done});if(n.length==a.length){console.log("start down zip");var o=new y.a;Object.keys(t).map(function(e){t[e].data.map(function(e){var t=o.folder(e.key);"pdf"==e.type?t.file(e.title,e.data,{binary:!0}):t.file(e.title,e.data,{base64:!0})})}),console.log(t),o.generateAsync({type:"blob"}).then(function(t){g.a.saveAs(t,"OVVO_Product.zip"),e.setState({downloadLoading:!1,downloadDone:!0})})}}},{key:"onSearchMethod",value:function(e){this.setState({searchMethod:e.target.value})}},{key:"onInputChange",value:function(e){this.setState({inputText:e.target.value})}},{key:"onSeriesChecked",value:function(e,t){var n=this.state.series;n[e].checked=t.target.checked,this.setState({series:Object(a.a)({},n)})}},{key:"onDownloadType",value:function(e,t){var n=this.state.downloadType;n[e]=t.target.checked,this.setState({downloadType:Object(a.a)({},n)})}},{key:"render",value:function(){var e=this;window.gapi;return p.a.createElement("div",{className:"App root"},p.a.createElement(U.a,{position:"static",color:"default"},p.a.createElement(q.a,null,p.a.createElement(Q.a,{variant:"h6",color:"inherit"},"OVVO Product / UPC Finder"))),!this.state.isSigin&&p.a.createElement(ae,{p:2},p.a.createElement(V.a,null,p.a.createElement(K.a,null,"Log in to Google Drive"),p.a.createElement(G.a,null,p.a.createElement(W.a,{variant:"contained",color:"primary",onClick:this.handleAuthClick.bind(this)},"Log in")))),this.state.isSigin&&p.a.createElement(ae,{p:2},this.state.downloadLoading&&p.a.createElement("div",null,p.a.createElement("br",null),p.a.createElement(te.a,{variant:"query"}),p.a.createElement("br",null)),p.a.createElement(V.a,null,p.a.createElement(K.a,null,p.a.createElement(E.a,{container:!0,spacing:24},p.a.createElement(E.a,{item:!0,xs:12},p.a.createElement(R.a,{id:"outlined-multiline-flexible",label:"Model name / model color",multiline:!0,rowsMax:"10",value:this.state.inputText,onChange:this.onInputChange.bind(this),margin:"normal",variant:"outlined",style:{width:"100%"}})),p.a.createElement(E.a,{item:!0,xs:12},p.a.createElement(j.a,{control:p.a.createElement(I.a,{checked:this.state.downloadType.product,value:"product",color:"primary",onChange:this.onDownloadType.bind(this,"product")}),label:"Product Image"}),p.a.createElement(j.a,{control:p.a.createElement(I.a,{checked:this.state.downloadType.upc,value:"upc",color:"primary",onChange:this.onDownloadType.bind(this,"upc")}),label:"UPC"}))))),p.a.createElement(V.a,null,p.a.createElement(K.a,null,p.a.createElement(W.a,{disabled:this.state.downloadLoading,variant:"contained",color:"primary",onClick:this.onDownloadZIP},"Download ZIP")),this.state.downloadDone&&p.a.createElement(x.a,null,p.a.createElement(F.a,null,p.a.createElement(Z.a,null,p.a.createElement(T.a,null,"folder Name"),p.a.createElement(T.a,{align:"right"},"Itmes"),p.a.createElement(T.a,{align:"right"},"Total"))),p.a.createElement(D.a,null,Object.keys(this.state.searchItem).map(function(t){return p.a.createElement(Z.a,{key:t},p.a.createElement(T.a,{component:"th",scope:"row"},t),p.a.createElement(T.a,{align:"right"},e.state.searchItem[t].data.map(function(e,t){return p.a.createElement("div",{key:t},e.title)})),p.a.createElement(T.a,{align:"right"},e.state.searchItem[t].data.length))}))))))}}]),n}(h.Component);t.a=oe}).call(this,n(29).Buffer)},201:function(e,t,n){e.exports=n(444)},206:function(e,t,n){},230:function(e,t){},232:function(e,t){},278:function(e,t,n){},444:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(17),l=n.n(i),r=(n(206),n(175));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(r.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[201,2,1]]]);
//# sourceMappingURL=main.50cfb2cb.chunk.js.map